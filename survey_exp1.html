<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Action Classification Research Survey</title>
    <style>
        /* CSS Styles */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f4f4f9;
            color: #333;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
        }
        .quiz-container {
            background: #fff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            max-width: 800px;
            width: 100%;
        }
        h1, h2, h3 {
            color: #0056b3;
        }
        .page {
            display: none; /* Hide all pages by default */
        }
        .page.active {
            display: block; /* Show the current active page */
        }
        /* Video styles */
        .video-container {
            text-align: center;
            margin: 20px 0;
        }
        #video-wrapper {
            width: 640px;
            height: 360px;
            margin: 0 auto;
            position: relative;   /* Áµ¶ overlay Áî® */
            background: black;
            overflow: hidden;
        }

        /* ËÆì <video> Â°´ÊªøÈÄôÂÄãÂçÄÂüü */
        #video-wrapper video {
            width: 100%;
            height: 100%;
            object-fit: cover; /* Â°´ÊªøÁï´Èù¢ÔºåÂèØËÉΩË£ÅÊéâ‰∏ÄÈªûÈÇä */
        }
        .video-container video {
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        /* Option button styles */
        .options-container button {
            display: block;
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            background-color: #e9ecef;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .options-container button:hover {
            background-color: #cfe2ff;
        }
        .next-btn {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            margin-top: 20px;
            cursor: pointer;
            border-radius: 4px;
        }
        .next-btn:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>

<div class="quiz-container">
    
    <div id="page1" class="page active">
        <h1>üé• A Comparative Analysis of Action Classification between Large Vision-Language Models and Human Observers </h1>
        
        <h2>Invitation to Participate</h2>
        <p>Hello,</p>
        <p>You are cordially invited to participate in a research study titled: <strong>"A Comparative Analysis of Action Classification between Large Vision-Language Models and Human Observers."</strong></p>
        <p>This research is being conducted by the Principal Investigator, Tzu Ling Liu (ywa826@usask.ca), at the University of Saskatchewan (Usask).</p>

        <h2>Purpose of the Study</h2>
        <p>The primary goal of this research is to compare the performance of <strong>human observers</strong> with that of <strong>Large Vision-Language Models (LVLMs)</strong> in <strong>video action classification</strong> tasks. Specifically, we aim to measure the <strong>accuracy of human subjective judgment</strong> and their corresponding <strong>reaction time</strong> when identifying different action categories shown in short video clips. Your participation will provide crucial human baseline data for this comparative study.</p>

        <h2>Participation Details & Confidentiality</h2>
        <ul>
            <li><strong>Eligibility:</strong> You must be an adult with normal visual capability and able to understand the task instructions.</li>
            <li><strong>Time Commitment:</strong> The estimated time required to complete this survey is approximately <strong>10 minutes</strong>.</li>
            <li><strong>Voluntary Nature:</strong> Your participation is entirely voluntary. You may stop or refuse to continue at any time without penalty.</li>
            <li><strong>Anonymity & Data Usage:</strong> This survey is conducted <strong>anonymously</strong>. All collected data will be processed via de-identification and used solely for academic research purposes.</li>
            <li><strong>Irreversible Submission:</strong> Due to the anonymous nature, once you submit your responses, it will be impossible to identify and subsequently remove your data.</li>
        </ul>
        
        <hr>
        
        <h2>‚úÖ Consent Statement</h2>
        <p>By clicking the button below, you are confirming that you have read and understood the information provided and voluntarily consent to participate in this anonymous research study.</p>

        <button class="next-btn" onclick="nextPage(2)">I agree and want to proceed to demographics</button>
        
    </div>

    <div id="page2" class="page">
        <h2>üßë‚Äçü§ù‚Äçüßë Demographic Information (Anonymous)</h2>
        <p>Please fill in the following information. All data will be used for statistical analysis only.</p>
        
        <label for="age">Age (Years):</label>
        <input type="number" id="age" name="age" required><br><br>

        <label>Gender:</label>
        <select id="gender" name="gender">
            <option value="male">Male</option>
            <option value="female">Female</option>
            <option value="other">Other / Prefer not to say</option>
        </select><br><br>

        <label for="background">Professional Background (Select the most relevant):</label>
        <select id="background" name="background">
            <option value="none">None / Not Applicable</option>
            
            <option value="cv">Computer Vision / Image Processing</option>
            <option value="ai_ml">Artificial Intelligence / Machine Learning</option>
            <option value="cs">Computer Science / Software Engineering</option>
            <option value="data">Data Science / Data Analytics</option>
            <option value="robotics">Robotics / Automation</option>
            
            <option value="psychology">Psychology / Experimental Psychology</option>
            <option value="neuroscience">Neuroscience / Cognitive Science</option>
            <option value="hci">Human-Computer Interaction (HCI)</option>
            <option value="linguistics">Linguistics / Natural Language Processing (NLP)</option>
            
            <option value="ee">Electrical Engineering / Electronic Engineering</option>
            <option value="me">Mechanical Engineering</option>
            <option value="biomed">Biomedical Engineering</option>
            <option value="physics">Physics</option>
            <option value="math">Mathematics / Statistics</option>
            
            <option value="sports">Sports Science / Kinesiology</option>
            <option value="pt_ot">Physical Therapy / Occupational Therapy</option>
            <option value="medicine">Medicine / Healthcare</option>
            
            <option value="business">Business / Management</option>
            <option value="humanities">Humanities / Social Sciences (General)</option>
            <option value="art_design">Art / Design / Media Studies</option>
            
            <option value="other_specific">Others</option>
        </select><br><br>

        <button class="next-btn" onclick="startQuiz()">Next</button>
    </div>
    <!-- Instruction Page -->
    <div id="page3" class="page">
        <h2>üìå Instructions for the Upcoming Action Classification Task</h2>

        <p>In the next section, you will watch a series of short video clips and determine the category of human action shown in each video.</p>

        <h3>üéØ Task Procedure</h3>
        <ul>
            <li>The moment you click to start the video, the reaction time will begin recording.</li>
            <li>You must select an answer <strong>as quickly and accurately as possible</strong>.</li>
            <li>Your response speed and correctness will both be analyzed.</li>
        </ul>

        <h3>üß† Action Categories</h3>
        <p>There will be <strong>8 possible action categories</strong> for each video:</p>
        <div style="background:#eef5ff; padding:10px; border-radius:8px; border:1px solid #d0d8e8;">
            Drink, Jump, Pick, Pour, Push, Run, Walk, Wave
        </div>

        <h3>üìπ Number of Trials</h3>
        <p>You will classify a total of <strong>24 video clips</strong>. Each clip will display only one of the eight actions.</p>

        <h3>‚ö†Ô∏è Important Notes</h3>
        <ul>
            <li>Once you select an answer, the next video will automatically appear.</li>
            <li>Please stay focused and avoid external distractions.</li>
            <li>There are no right or wrong strategies‚Äîrespond naturally.</li>
        </ul>

        <button class="next-btn" onclick="beginClassification()">Start the Classification Task</button>

    </div>

    <div id="quiz-page" class="page">
        <h3 id="question-title"></h3>
        
        <div class="video-container">
            <div id="video-embed-container" style="width: 640px; height: 360px; margin: 0 auto;"></div>
            <p style="font-size: small;">*Please select your answer as quickly as possible.</p>
        </div>

        <div id="options-container" class="options-container">
            </div>
    </div>

    <div id="finish-page" class="page">
        <h1>üéâ Thank You for Your Participation</h1>

        <p>Your responses have been successfully recorded and will be included in the analysis phase of this research study.</p>
        <p>Your contribution is valuable and will assist in advancing our understanding of human performance in video-based action recognition.</p>

        <p>If you have any questions regarding the study, please contact <strong>ywa826@usask.ca</strong>.</p>

        <p>Sincerely appreciate your time and participation.</p>
    </div>

</div>

<script>
    // JavaScript Logic
    const quizData = [
        {
            videoUrl: "exp_videos/Drink1.mp4", //drink1
            correctAnswer: "Drink",
            options: ["Drink", "Jump", "Pick", "Pour", "Push", "Run", "Walk", "Wave"]
        },
        {
            videoUrl: "exp_videos/Drink2.mp4", //drink2
            correctAnswer: "Drink",
            options: ["Drink", "Jump", "Pick", "Pour", "Push", "Run", "Walk", "Wave"]
        },
        {
            videoUrl: "exp_videos/Drink3.mp4", //drink3
            correctAnswer: "Drink",
            options: ["Drink", "Jump", "Pick", "Pour", "Push", "Run", "Walk", "Wave"]
        },
        {
            videoUrl: "exp_videos/Jump1.mp4", //jump1
            correctAnswer: "Jump",
            options: ["Drink", "Jump", "Pick", "Pour", "Push", "Run", "Walk", "Wave"]
        },
        {
            videoUrl: "exp_videos/Jump2.mp4", //jump2
            correctAnswer: "Jump",
            options: ["Drink", "Jump", "Pick", "Pour", "Push", "Run", "Walk", "Wave"]
        },
        {
            videoUrl: "exp_videos/Jump3.mp4", //jump3
            correctAnswer: "Jump",
            options: ["Drink", "Jump", "Pick", "Pour", "Push", "Run", "Walk", "Wave"]
        },
        {
            videoUrl: "exp_videos/Pour1.mp4", //pour1
            correctAnswer: "Pour",
            options: ["Drink", "Jump", "Pick", "Pour", "Push", "Run", "Walk", "Wave"]
        },
        {
            videoUrl: "exp_videos/Pour2.mp4", //pour2
            correctAnswer: "Pour",
            options: ["Drink", "Jump", "Pick", "Pour", "Push", "Run", "Walk", "Wave"]
        },
        {
            videoUrl: "exp_videos/Pour3.mp4", //pour3
            correctAnswer: "Pour",
            options: ["Drink", "Jump", "Pick", "Pour", "Push", "Run", "Walk", "Wave"]
        },
        {
            videoUrl: "exp_videos/Run1.mp4", //run1
            correctAnswer: "Run",
            options: ["Drink", "Jump", "Pick", "Pour", "Push", "Run", "Walk", "Wave"]
        },
        {
            videoUrl: "exp_videos/Run2.mp4", //run2
            correctAnswer: "Run",
            options: ["Drink", "Jump", "Pick", "Pour", "Push", "Run", "Walk", "Wave"]
        },
        {
            videoUrl: "exp_videos/Run3.mp4", //run3
            correctAnswer: "Run",
            options: ["Drink", "Jump", "Pick", "Pour", "Push", "Run", "Walk", "Wave"]
        },
        {
            videoUrl: "exp_videos/Pick1.mp4", //pick1
            correctAnswer: "Pick",
            options: ["Drink", "Jump", "Pick", "Pour", "Push", "Run", "Walk", "Wave"]
        },
        {
            videoUrl: "exp_videos/Pick2.mp4", //pick2
            correctAnswer: "Pick",
            options: ["Drink", "Jump", "Pick", "Pour", "Push", "Run", "Walk", "Wave"]
        },
        {
            videoUrl: "exp_videos/Pick3.mp4", //pick3
            correctAnswer: "Pick",
            options: ["Drink", "Jump", "Pick", "Pour", "Push", "Run", "Walk", "Wave"]
        },
        {
            videoUrl: "exp_videos/Push1.mp4", //push1
            correctAnswer: "Push",
            options: ["Drink", "Jump", "Pick", "Pour", "Push", "Run", "Walk", "Wave"]
        },
        {
            videoUrl: "exp_videos/Push2.mp4", //push2
            correctAnswer: "Push",
            options: ["Drink", "Jump", "Pick", "Pour", "Push", "Run", "Walk", "Wave"]
        },
        {
            videoUrl: "exp_videos/Push3.mp4", //push3
            correctAnswer: "Push",
            options: ["Drink", "Jump", "Pick", "Pour", "Push", "Run", "Walk", "Wave"]
        },
        {
            videoUrl: "exp_videos/Walk1.mp4", //walk1
            correctAnswer: "Walk",
            options: ["Drink", "Jump", "Pick", "Pour", "Push", "Run", "Walk", "Wave"]
        },
        {
            videoUrl: "exp_videos/Walk2.mp4", //walk2
            correctAnswer: "Walk",
            options: ["Drink", "Jump", "Pick", "Pour", "Push", "Run", "Walk", "Wave"]
        },
        {
            videoUrl: "exp_videos/Walk3.mp4", //walk3
            correctAnswer: "Walk",
            options: ["Drink", "Jump", "Pick", "Pour", "Push", "Run", "Walk", "Wave"]
        },
        {
            videoUrl: "exp_videos/Wave1.mp4", //wave1
            correctAnswer: "Wave",
            options: ["Drink", "Jump", "Pick", "Pour", "Push", "Run", "Walk", "Wave"]
        },
        {
            videoUrl: "exp_videos/Wave2.mp4", //wave2
            correctAnswer: "Wave",
            options: ["Drink", "Jump", "Pick", "Pour", "Push", "Run", "Walk", "Wave"]
        },
        {
            videoUrl: "exp_videos/Wave3.mp4", //wave3
            correctAnswer: "Wave",
            options: ["Drink", "Jump", "Pick", "Pour", "Push", "Run", "Walk", "Wave"]
        }
        
    ];
    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]]; // change elements
        }
    }
    function addOriginalIndex(array) {
        array.forEach((question, index) => {
            // Á¢∫‰øùÈ°åÁõÆÁâ©‰ª∂ÊúâÈÄôÂÄãÂ±¨ÊÄß
            question.originalIndex = index;
        });
    }
    addOriginalIndex(quizData);
    // before starting the quiz, shuffle the questions
    shuffleArray(quizData);
    

    let currentPage = 1;
    let currentQuestionIndex = 0;
    let startTime;
    let uniqueID = null;
    const allResponses = {
        demographics: {},
        questions: []
    };

    /**
     * Switches the active page display.
     * @param {number} pageNum - The page number to display (1:Intro, 2:Demographics, 3:Quiz, 4:Finish)
     */
    function nextPage(pageNum) {
        document.querySelectorAll('.page').forEach(page => {
            page.classList.remove('active');
        });
        document.getElementById(`page${pageNum}`).classList.add('active');
        currentPage = pageNum;
    }

    /**
     * Transitions from demographics to the quiz page and saves demographics data.
     */
    function startQuiz() {
        // Save demographic data
        uniqueID = 'UID-' + Date.now() + Math.floor(Math.random() * 1000); 

        // 2. ÂÑ≤Â≠òÂü∫Êú¨Ë≥áÊñô
        allResponses.demographics = {
            unique_id: uniqueID, 
            age: document.getElementById('age').value,
            gender: document.getElementById('gender').value,
            background: document.getElementById('background').value
        };

        if (!allResponses.demographics.age || allResponses.demographics.age <= 0) {
            alert("Please enter a valid age!");
            return;
        }

        nextPage(3); // Go to instructions page
    }

    /**
     * Loads and displays the next question.
     * @param {number} index - The index of the current question.
     */
    /**
     * Loads and displays the next question using YouTube iframe.
     * @param {number} index - The index of the current question.
     */
    function removeCover() {
        const cover = document.getElementById('cover-overlay');
        const video = document.getElementById('exp-video');

        // From the moment the participant starts watching the video, start timing
        startTime = performance.now();

        if (video) {
            // Try to play the video
            const playPromise = video.play();
            if (playPromise !== undefined) {
                playPromise.catch(err => {
                    console.error('Video play blocked:', err);
                });
            }
        }

        if (cover) {
            cover.remove();
        }
    }



    function loadQuestion(index) {
        if (index >= quizData.length) {
            finishQuiz();
            return;
        }

        const question = quizData[index];
        const embedContainer = document.getElementById('video-embed-container');
        const optionsContainer = document.getElementById('options-container');
        const questionTitle = document.getElementById('question-title');

        // È°åÁõÆÊ®ôÈ°å
        questionTitle.textContent = `Question ${index + 1}/${quizData.length}: Action Classification Task`;

        // Áî® HTML5 <video> Êí≠Êîæ GitHub Pages ‰∏äÁöÑ mp4
        embedContainer.innerHTML = `
            <div id="video-wrapper">
                <video
                    id="exp-video"
                    muted
                    playsinline
                >
                    <source src="${question.videoUrl}" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
                <div 
                    id="cover-overlay" 
                    style="
                        position: absolute; 
                        top: 0; 
                        left: 0; 
                        width: 100%; 
                        height: 100%; 
                        background-color: black;
                        z-index: 10; 
                        display: flex;
                        justify-content: center;
                        align-items: center;
                        color: white;
                        font-size: 24px;
                        cursor: pointer;
                    "
                    onclick="removeCover()">
                    Click to Start Video
                </div>
            </div>
        `;

        // Create option buttons
        optionsContainer.innerHTML = '';
        question.options.forEach(option => {
            const button = document.createElement('button');
            button.textContent = option;
            button.onclick = () => recordResponse(option);
            optionsContainer.appendChild(button);
        });

        // The timing start point is moved to removeCover(), so we no longer set startTime here
        currentQuestionIndex = index;
    }



    function beginClassification() {
        document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
        document.getElementById('quiz-page').classList.add('active');
        loadQuestion(0);
    }

    /**
     * Records the participant's answer and reaction time.
     * @param {string} selectedAnswer - The answer chosen by the participant.
     */
    function recordResponse(selectedAnswer) {
        // Stop the timer
        const endTime = performance.now();
        const reactionTime = (endTime - startTime) / 1000; // Convert to seconds (s)

        const currentQuestion = quizData[currentQuestionIndex];
        const isCorrect = selectedAnswer === currentQuestion.correctAnswer;
        const originalQuestionNumber = currentQuestion.originalIndex + 1;

        // Store the result for this question
        allResponses.questions.push({
            q_index: originalQuestionNumber,
            video_url: currentQuestion.videoUrl,
            selected_answer: selectedAnswer,
            correct_answer: currentQuestion.correctAnswer,
            is_correct: isCorrect,
            reaction_time_s: reactionTime.toFixed(3) // Fixed to three decimal places
        });

        // Load the next question
        loadQuestion(currentQuestionIndex + 1);
    }

    

    /**

    * Ends the quiz and sends data to the Google Apps Script backend.

    */

    function finishQuiz() {

        document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));

        document.getElementById('finish-page').classList.add('active');



        // **************** ÊõøÊèõÊàêÊÇ®Âæû Apps Script Áç≤ÂæóÁöÑ URL ****************

        const GOOGLE_APP_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyytLSsCE_e6OOk3j71M-gJzGb7kLbTvOViztpTKaJJE63O4L85_16TuhvfRP2cs1_A/exec'; 

        // ***************************************************************



        // ‰ΩøÁî® Fetch API Â∞á JSON Êï∏ÊìöÁôºÈÄÅÂà∞ Google Apps Script

        fetch(GOOGLE_APP_SCRIPT_URL, {

            method: 'POST',

            mode: 'no-cors', // ÂøÖÈ†àË®≠ÂÆöÁÇ∫ no-corsÔºåÂõ†ÁÇ∫ÊòØË∑®ÂüüË´ãÊ±Ç

            headers: {

                'Content-Type': 'text/plain' // ‰ΩøÁî® text/plain ÈÅøÂÖçË§áÈõúÁöÑ CORS È†êÊ™¢

            },

            body: JSON.stringify(allResponses)

        })

        .then(response => {

            // ÊàêÂäüÁôºÈÄÅÂæåÔºåÂú® Console Ë®òÈåÑÊàêÂäüÔºå‰ΩÜÂ∞çÁî®Êà∂‰∏çÈ°ØÁ§∫‰ªª‰ΩïË≥áË®ä

            console.log("Data successfully sent to Google Sheet via Apps Script.");

        })

        .catch(error => {

            // Â¶ÇÊûúÁôºÈÄÅÂ§±ÊïóÔºåÈÄöÁü•Á†îÁ©∂ËÄÖ (Âú® Console ‰∏≠È°ØÁ§∫)

            console.error('Error sending data to Google Sheet:', error);

            console.log("TESTER VIEW: Please report this error: Data submission failed.");

        });



        // ‰æùÁÑ∂‰øùÁïô console.log Êñπ‰æøÁ†îÁ©∂ËÄÖËá™Â∑±Ê∏¨Ë©¶

        console.log("--- RESEARCH DATA START (Local Copy) ---");

        console.log(JSON.stringify(allResponses, null, 2));

        console.log("--- RESEARCH DATA END ---");

    }

</script>
</body>
</html>